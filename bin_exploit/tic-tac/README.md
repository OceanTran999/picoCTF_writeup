![Chal](https://github.com/OceanTran999/picoCTF_writeup/assets/100577019/1b801f0c-aedb-4262-9886-9dda6634a4a3)


In this challenge, I connect to server through SSH as user `ctf-player`, first I will list all files in current directory.


![ls](https://github.com/OceanTran999/picoCTF_writeup/assets/100577019/4c624d48-c405-4302-9f04-fb04601cdeb5)


There's a `src.cpp` file which is owned by `ctf-player` and the binary file `txtreader` which is owned by `root`. Show the source code of `src.cpp`, we can see that the `src.cpp` will show the content of specific file if the permission of current user is valid, and the `txtreader` is the binary file of `.cpp` file.

![main](https://github.com/OceanTran999/picoCTF_writeup/assets/100577019/edfa2a20-eadf-4f01-9047-d62e37084ebc)


We can see that, in the line code `stat(filename.c_str(), &statbuf)` and line `is_open()`, there is a race-condition vulnerability as we don't know whether the program is handling a single file or not.

![Race_cond](https://github.com/OceanTran999/picoCTF_writeup/assets/100577019/025802bb-182a-46f0-b526-44625fc74a13)


To solve this challenge, first I will create `hello.txt` file and `temp.txt` file, then I will make symbolic links between the `hello.txt` and `temp.txt` file, `flag.txt` and `temp.txt' file. I can also substitude the `hello.txt` with `src.cpp` file as it is made by `ctf-player`.

![symbolic_link](https://github.com/OceanTran999/picoCTF_writeup/assets/100577019/d09eeaa6-ba96-4c1d-82a0-5982e32dceda)


List the current directory again, we can see that the `temp.txt` file links 2 files simultaneously.

![ls2](https://github.com/OceanTran999/picoCTF_writeup/assets/100577019/ef187b0f-20e5-417f-8270-c28d0a97abc1)


Finally, run the vulnerable program with `temp.txt` file, it might be take too long to get the flag.

![run_loop](https://github.com/OceanTran999/picoCTF_writeup/assets/100577019/430cbbe8-25a0-49da-8b08-272e01e743e8)


![flag](https://github.com/OceanTran999/picoCTF_writeup/assets/100577019/5da66ed7-e471-4d1e-92c1-96030a4f5d1d)
