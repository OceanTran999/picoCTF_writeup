![Chal](https://github.com/OceanTran999/picoCTF_writeup/assets/100577019/1bd664e7-83e1-473b-b9d9-c445555facc9)


Check file's protection:

![Checksec](https://github.com/OceanTran999/picoCTF_writeup/assets/100577019/5f2cfb24-f74f-4083-b1c9-64398a57a4ff)


Here're some functions:

![main](https://github.com/OceanTran999/picoCTF_writeup/assets/100577019/019f71d2-122f-4f27-b810-f9868b177a21)


![win](https://github.com/OceanTran999/picoCTF_writeup/assets/100577019/bc20df07-b80a-4a93-b0ae-ba4cb5ce3429)


![print_segf_mess](https://github.com/OceanTran999/picoCTF_writeup/assets/100577019/88a36b3d-87a1-43c2-865c-3500846f0c18)


We can see that this is the `ret2win` challenge which has the function to print the flag if we call it. In `line 45` we can see that there's a format string `%x`, so I will check the man page:

![manpage](https://github.com/OceanTran999/picoCTF_writeup/assets/100577019/195aac28-3861-46f6-bfdf-8f93c5f9a3e2)


Running the program with an abitrary number `12`, it returns error message.

![run1](https://github.com/OceanTran999/picoCTF_writeup/assets/100577019/2d6acf33-901e-4e5c-813b-4d22b4c0170f)


To solve this challenge, in `line 47, 48` in `main` function. I see that after inputting the `val` variable, it will move the value of `val` to `foo(void)` function as a function (I think) in `line 47`, and call it in `line 48`. Therefore I just need the address of `win` function to get the flag.

![objdump](https://github.com/OceanTran999/picoCTF_writeup/assets/100577019/b4518dad-fba7-4ccc-8952-8d93f66831a0)


![flag](https://github.com/OceanTran999/picoCTF_writeup/assets/100577019/0579de08-7943-429d-8178-72a462deb3ba)
